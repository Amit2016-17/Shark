
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Random Forest &#8212; Shark 3.0a documentation</title>
    <script type="text/x-mathjax-config">
        MathJax.Ajax.timeout = 5000;  <!-- 5 second rather than 15 seconds timeout for file access -->
        <!-- ( nicked from https://groups.google.com/forum/#!msg/mathjax-users/HKA2lNqv-OQ/_Yv72L7MtjYJ ) -->
    </script>
    <link rel="stylesheet" href="../../../_static/mt_sphinx_deriv.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS-MML_HTMLorMML&delayStartupUntilConfig"></script>
    <link rel="shortcut icon" href="../../../_static/shark16.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Support Vector Machines: First Steps" href="svm.html" />
    <link rel="prev" title="Variational Autoencoders" href="variational_autoencoders.html" />
    <link rel="stylesheet" href="../../../_static/mt_sphinx_shark.css" type="text/css" />
    <script type="text/javascript">
       window.MathJax || document.write('<script src="../../../index/../../../../../contrib/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML&delayStartupUntilConfig"><\/script>');
       <!--delay nicked from https://groups.google.com/forum/#!msg/mathjax-users/J-36V22-G9Q/AW3ncCbJzS8J -->
    </script>
    <script src="../../../index/../../../../mlstyle.js"></script>
    <!-- nicked from https://groups.google.com/forum/#!msg/mathjax-users/J-36V22-G9Q/AW3ncCbJzS8J -->

  </head><body>

    <div id="shark_old">
        <div id="wrap">
            <div id="header">
                <div id="site-name"><a href="/shark/index.html">Shark machine learning library</a></div>
                <ul id="nav">
                    <li  class="first" >
                        <a href="../../installation.html">Installation</a>
                    </li>
                    <li  class="active" >
                        <a href="../tutorials.html">Tutorials</a>
                    </li>
		    <li  class="first" >
                        <a href="../../benchmark.html">Benchmarks</a>
                    </li>
		    <li  class="first" >
                        <a href="../../../index/../../../../doxygen_pages/html/classes.html">Documentation</a>
                        <ul>
                            <li><a href="../../quickref/quickref.html">Quick references</a></li>
                            <li><a href="../../../index/../../../../doxygen_pages/html/classes.html">Class list</a></li>
                            <li class="last"><a href="../../../index/../../../../doxygen_pages/html/group__shark__globals.html">Global functions</a></li>
                        </ul>
                    </li>
                </ul>

            </div>
        </div>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
        <p class="logo"><a href="../../../index.html">
          <img class="logo" src="../../../_static/SharkLogo.png" alt="Logo"/></a></p>
	<div class="mt_ltocwrapper">
		<ul>
<li><a class="reference internal" href="#">Random Forest</a><ul>
<li><a class="reference internal" href="#background">Background</a></li>
<li><a class="reference internal" href="#random-forest-in-shark">Random Forest in Shark</a></li>
<li><a class="reference internal" href="#full-example-program">Full example program</a></li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>

	</div>
<div>
  <a class="topless" href="variational_autoencoders.html" title="previous chapter">
	  <img class="navicon" src="../../../_static/icon_backward.png" alt="prev"/> Variational Autoencoders</a>
  <a class="topless" href="svm.html" title="next chapter">
	  <img class="navicon" src="../../../_static/icon_forward.png" alt="next"/> Support Vector Machines: First Steps</a>
</div> 
<div id="searchbox" style="display: none">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" size="12" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
      <input class="mtsubmitbutton" type="submit" value="Find" />
    </form>
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
<p class="mtshowsource">
  <a href="../../../_sources/rest_sources/tutorials/algorithms/rf.rst.txt"
           rel="nofollow"><img class="sourceicon" src="../../../_static/icon_eject.png" alt="prev"/> Show page source</a>
</p>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="random-forest">
<h1>Random Forest<a class="headerlink" href="#random-forest" title="Permalink to this headline">¶</a></h1>
<div class="section" id="background">
<h2>Background<a class="headerlink" href="#background" title="Permalink to this headline">¶</a></h2>
<p>Random Forest is a decision tree algorithm for both classification and
regression. It was first described by <a class="reference internal" href="#breiman2001" id="id1">[Breiman2001]</a>. It is a recursive
algorithm which partitions the training dataset by doing binary splits based on the labels of the data.
It builds an ensemble of models, and uses randomization to increase the variance
between the trees of the ensemble. It performs remarkable well in practice, and
is widely used.</p>
</div>
<div class="section" id="random-forest-in-shark">
<h2>Random Forest in Shark<a class="headerlink" href="#random-forest-in-shark" title="Permalink to this headline">¶</a></h2>
<p>For this tutorial, the following includes are needed:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;shark/Data/Csv.h&gt; //importing the file</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;shark/Algorithms/Trainers/RFTrainer.h&gt; //the random forest trainer</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;shark/ObjectiveFunctions/Loss/ZeroOneLoss.h&gt; //zero one loss for evaluation</span><span class="cp"></span>
</pre></div>
</div>
<div class="section" id="sample-classification-problem-protein-fold-prediction">
<h3>Sample classification problem: Protein fold prediction<a class="headerlink" href="#sample-classification-problem-protein-fold-prediction" title="Permalink to this headline">¶</a></h3>
<p>Let us consider the same bioinformatics problem as in the
<a class="reference internal" href="nearestNeighbor.html"><span class="doc">Nearest Neighbor Classification</span></a> and <a class="reference internal" href="lda.html"><span class="doc">Linear Discriminant Analysis</span></a> tutorial, namely the prediction of the
secondary structure of proteins. The goal is to assign a protein to
one out of 27 SCOP fold types <a class="reference internal" href="lda.html#dingdubchak2001a" id="id2">[DingDubchak2001a]</a>.  We again consider
the descriptions of amino-acid sequences provided by
<a class="reference internal" href="lda.html#damoulasgirolami2008a" id="id3">[DamoulasGirolami2008a]</a>.  The data <a class="reference download internal" href="../../../_downloads/C.csv" download=""><code class="xref download docutils literal notranslate"><span class="pre">C.csv</span></code></a>
provide a description of the amino-acid compositions of 695 proteins
together with the corresponding fold type. Each row corresponds to a
protein.  After downloading the data <a class="reference download internal" href="../../../_downloads/C.csv" download=""><code class="xref download docutils literal notranslate"><span class="pre">C.csv</span></code></a> we
can read, inspect and split the data as described in the
<a class="reference internal" href="nearestNeighbor.html"><span class="doc">Nearest Neighbor Classification</span></a> tutorial:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">ClassificationDataset</span> <span class="n">data</span><span class="p">;</span>
<span class="n">importCSV</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;data/C.csv&quot;</span><span class="p">,</span> <span class="n">LAST_COLUMN</span><span class="p">,</span> <span class="sc">&#39; &#39;</span><span class="p">);</span>

<span class="c1">//Split the dataset into a training and a test dataset</span>
<span class="n">ClassificationDataset</span> <span class="n">dataTest</span> <span class="o">=</span> <span class="n">splitAtElement</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="mi">311</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="model-and-learning-algorithm">
<h3>Model and learning algorithm<a class="headerlink" href="#model-and-learning-algorithm" title="Permalink to this headline">¶</a></h3>
<p>We can use the <a class="reference external" href="../../../../../../doxygen_pages/html/classshark_1_1_r_f_trainer.html">RFTrainer</a> class to train a <a class="reference external" href="../../../../../../doxygen_pages/html/classshark_1_1_r_f_classifier.html">RFClassifier</a> which represents a Random Forest:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">RFTrainer</span><span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="o">&gt;</span> <span class="n">trainer</span><span class="p">;</span>
<span class="n">RFClassifier</span><span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="o">&gt;</span> <span class="n">model</span><span class="p">;</span>
<span class="n">trainer</span><span class="p">.</span><span class="n">train</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="evaluating-the-model">
<h3>Evaluating the model<a class="headerlink" href="#evaluating-the-model" title="Permalink to this headline">¶</a></h3>
<p>After training the model we can evaluate it.  As a performance
measure, we consider the standard 0-1 loss.  The corresponding risk is
the probability of error, the empirical risk is the average
classification error.  When measured on set of sample patterns, it
simply computes the fraction of wrong predictions:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">ZeroOneLoss</span><span class="o">&lt;&gt;</span> <span class="n">loss</span><span class="p">;</span>
<span class="k">auto</span> <span class="n">prediction</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="n">inputs</span><span class="p">());</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Random Forest on training set accuracy: &quot;</span> <span class="o">&lt;&lt;</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">loss</span><span class="p">.</span><span class="n">eval</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="n">labels</span><span class="p">(),</span> <span class="n">prediction</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>

<span class="n">prediction</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">dataTest</span><span class="p">.</span><span class="n">inputs</span><span class="p">());</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Random Forest on test set accuracy:     &quot;</span> <span class="o">&lt;&lt;</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">loss</span><span class="p">.</span><span class="n">eval</span><span class="p">(</span><span class="n">dataTest</span><span class="p">.</span><span class="n">labels</span><span class="p">(),</span> <span class="n">prediction</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>Of course, the accuracy is given by one minus the error.
In this example, Random Forest outperforms LDA and KNN.</p>
</div>
<div class="section" id="parameters-of-the-trainer">
<h3>Parameters of the trainer<a class="headerlink" href="#parameters-of-the-trainer" title="Permalink to this headline">¶</a></h3>
<p>The trainer has some properties that can be set to tweak the learning process.
All parameters have meaningful default values. The parameters are set by the
following methods:</p>
<table border="1" class="docutils">
<colgroup>
<col width="51%" />
<col width="49%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Method</th>
<th class="head">Effect</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">setMTry(size_t</span> <span class="pre">mtry)</span></code></td>
<td>Number of random attribute to try at
each inner node of each tree.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">setNTrees(size_t</span> <span class="pre">nTrees)</span></code></td>
<td>Number of trees to be built.
Typically this would be 100+.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">setNodeSize(size_t</span> <span class="pre">nodeSize)</span></code></td>
<td>The maximum nodesize, before a node
is classified as a leaf. Lowering this
value makes the trees in the ensemble
larger and increasing this value
makes the trees smaller.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">setOOBratio(double</span> <span class="pre">ratio)</span></code></td>
<td>Controls the ratio determining
the number of OOB (out-of-bag)
samples is sampled from the training
dataset.</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="full-example-program">
<h2>Full example program<a class="headerlink" href="#full-example-program" title="Permalink to this headline">¶</a></h2>
<p>The full example program is
<a class="reference external" href="../../../../../../doxygen_pages/html/_r_f_tutorial_8cpp.html">RFTutorial.cpp</a>.</p>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<table class="docutils citation" frame="void" id="breiman2001" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[Breiman2001]</a></td><td>L. Breiman.
Random Forests.
Machine Learning, vol. 45, issue 1, p. 5-32,
2001</td></tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>

    <div class="footer">
        <div class="footerlogos">
            <a href="http://validator.w3.org/check/referer" title="Valid XHTML 1.0">
                <img class="footerlogos" src="../../../_static/xhtml_validation.png" alt="Valid XHTML 1.0" />
            </a>
            <a href="http://jigsaw.w3.org/css-validator/check/referer?profile=css3" title="Valid CSS3">
                <img class="footerlogos" src="../../../_static/css_validation.png" alt="Valid CSS3" />
            </a>
        </div>
            &copy; The Shark developer team.
           Created on 11/06/2018
           using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.7.3
    </div>
  </body>
</html>